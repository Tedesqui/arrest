<!DOCTYPE html> <html lang="pt-BR"> <head> <meta charset="UTF-8"> <title>AR Reconhecimento Facial com Zoom Único e Multi Pessoas</title> <script defer src="https://cdn.jsdelivr.net/npm/face-api.js"></script> <style> body, html { margin: 0; overflow: hidden; font-family: sans-serif; } video { position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; object-fit: cover; transform: scaleX(-1); } canvas { position: fixed; top: 0; left: 0; z-index: 2; pointer-events: none; } #info { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.6); color: white; padding: 15px; border-radius: 10px; font-size: 16px; text-align: center; z-index: 3; max-width: 90%; white-space: pre-line; } #controls { position: fixed; top: 10px; right: 10px; z-index: 4; } #controls button { font-size: 18px; margin: 5px; padding: 8px 12px; background: #007bff; color: white; border: none; border-radius: 8px; cursor: pointer; } </style> </head> <body> <video id="video" autoplay muted playsinline></video> <canvas id="canvas"></canvas> <div id="info">Carregando IA e rostos...</div> <div id="controls"> <button onclick="toggleZoom()">Zoom 1x</button> </div> <script> const video = document.getElementById("video"); const canvas = document.getElementById("canvas"); const info = document.getElementById("info"); const zoomButton = document.querySelector("#controls button"); const people = [ { name: "Maria", info: "Arquiteta, 29 anos", images: 3 }, { name: "João", info: "Professor, 35 anos", images: 3 }, { name: "Carlos", info: "Engenheiro, 40 anos", images: 3 } ]; let mediaTrack; let zoomLevel = 1; async function toggleZoom() { zoomLevel = zoomLevel === 3 ? 1 : zoomLevel + 1; zoomButton.innerText = Zoom ${zoomLevel}x; if (mediaTrack && mediaTrack.getCapabilities) { const capabilities = mediaTrack.getCapabilities(); if (capabilities.zoom) { const constraints = { advanced: [{ zoom: zoomLevel }] }; await mediaTrack.applyConstraints(constraints); info.innerText = Zoom ajustado para ${zoomLevel}x; } else { info.innerText = "Zoom não suportado neste dispositivo."; } } } async function startCamera() { const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: { exact: "environment" }, width: { ideal: 1280 }, height: { ideal: 720 } } }); video.srcObject = stream; mediaTrack = stream.getVideoTracks()[0]; } async function loadLabeledImages() { return Promise.all( people.map(async person => { const descriptors = []; for (let i = 1; i <= person.images; i++) { const img = await faceapi.fetchImage(labeled/${person.name}/${i}.jpg); const detection = await faceapi .detectSingleFace(img) .withFaceLandmarks() .withFaceDescriptor(); if (detection) descriptors.push(detection.descriptor); } return new faceapi.LabeledFaceDescriptors(person.name, descriptors); }) ); } async function init() { await faceapi.nets.tinyFaceDetector.loadFromUri("https://cdn.jsdelivr.net/npm/face-api.js/weights"); await faceapi.nets.faceLandmark68Net.loadFromUri("https://cdn.jsdelivr.net/npm/face-api.js/weights"); await faceapi.nets.faceRecognitionNet.loadFromUri("https://cdn.jsdelivr.net/npm/face-api.js/weights"); await startCamera(); info.innerText = "Carregando imagens..."; const labeledDescriptors = await loadLabeledImages(); const matcher = new faceapi.FaceMatcher(labeledDescriptors, 0.6); video.addEventListener("play", () => { canvas.width = video.videoWidth; canvas.height = video.videoHeight; const ctx = canvas.getContext("2d"); setInterval(async () => { const detections = await faceapi .detectAllFaces(video, new faceapi.TinyFaceDetectorOptions()) .withFaceLandmarks() .withFaceDescriptors(); ctx.clearRect(0, 0, canvas.width, canvas.height); const resized = faceapi.resizeResults(detections, { width: canvas.width, height: canvas.height }); faceapi.draw.drawDetections(canvas, resized); if (detections.length > 0) { let foundPeople = []; detections.forEach(det => { const best = matcher.findBestMatch(det.descriptor); const match = people.find(p => p.name === best.label); if (match) { foundPeople.push(${match.name} - ${match.info}); } else { foundPeople.push("Pessoa não reconhecida"); } }); info.innerText = foundPeople.join('\n\n'); } else { info.innerText = "Nenhum rosto detectado."; } }, 1500); }); } init(); </script> </body> </html>
